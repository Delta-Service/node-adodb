/**
 * @module node-adodb
 * @author nuintun
 * @license MIT
 * @version 4.0.6
 * @description A Node.js JavaScript Client implementing the ADODB protocol.
 * @see https://github.com/nuintun/node-adodb
 */
!function(){"use strict";"object"!=typeof JSON&&(JSON={}),function(){var t=/^[\],:{}\s]*$/,e=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,n=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,r=/(?:^|:|,)(?:\s*\[)+/g,o=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;function u(t){return t<10?"0"+t:t}function c(){return this.valueOf()}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+u(this.getUTCMonth()+1)+"-"+u(this.getUTCDate())+"T"+u(this.getUTCHours())+":"+u(this.getUTCMinutes())+":"+u(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=c,Number.prototype.toJSON=c,String.prototype.toJSON=c);var f,a,p,s;function l(t){return o.lastIndex=0,o.test(t)?'"'+t.replace(o,function(t){var e=p[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function O(t,e){var n,r,o,i,u,c=f,p=e[t];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(t)),"function"==typeof s&&(p=s.call(e,t,p)),typeof p){case"string":return l(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";if(f+=a,u=[],"[object Array]"===Object.prototype.toString.apply(p)){for(i=p.length,n=0;n<i;n+=1)u[n]=O(n,p)||"null";return o=0===u.length?"[]":f?"[\n"+f+u.join(",\n"+f)+"\n"+c+"]":"["+u.join(",")+"]",f=c,o}if(s&&"object"==typeof s)for(i=s.length,n=0;n<i;n+=1)"string"==typeof s[n]&&(o=O(r=s[n],p))&&u.push(l(r)+(f?": ":":")+o);else for(r in p)Object.prototype.hasOwnProperty.call(p,r)&&(o=O(r,p))&&u.push(l(r)+(f?": ":":")+o);return o=0===u.length?"{}":f?"{\n"+f+u.join(",\n"+f)+"\n"+c+"}":"{"+u.join(",")+"}",f=c,o}}"function"!=typeof JSON.stringify&&(p={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(t,e,n){var r;if(f="",a="","number"==typeof n)for(r=0;r<n;r+=1)a+=" ";else"string"==typeof n&&(a=n);if(s=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return O("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(o,u){var c;function f(t,e){var n,r,o=t[e];if(o&&"object"==typeof o)for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&((r=f(o,n))!==undefined?o[n]=r:delete o[n]);return u.call(t,e,o)}if(o=String(o),i.lastIndex=0,i.test(o)&&(o=o.replace(i,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),t.test(o.replace(e,"@").replace(n,"]").replace(r,"")))return c=eval("("+o+")"),"function"==typeof u?f({"":c},""):c;throw new SyntaxError("JSON.parse")})}();function t(t){t.State&&t.Close()}function e(t){WScript.StdOut.Write(JSON.stringify(t))}function n(t){WScript.StdErr.Write(t)}function r(t){return 7===t||64===t||133===t||134===t||135===t}function o(t){return 128===t||204===t||205===t}function i(e){var n=new ActiveXObject("ADODB.Stream");n.Type=1,n.Open(),n.Position=0,n.Write(e),n.Position=0,n.Type=2;var r=n.ReadText();return t(n),r}function u(t){var e=[],n=t.Fields;if(!t.BOF||!t.EOF){var r,o,u,c,f,a=n.Count;for(t.MoveFirst();!t.EOF;){for(o={},r=0;r<a;r++)c=(u=n.Item(r)).Type,f=u.Value,7===(s=c)||64===s||133===s||134===s||135===s?f=new Date(f):(128===(p=c)||204===p||205===p)&&(f=i(f)),o[u.Name]=f;e.push(o),t.MoveNext()}}var p,s;return e}var c={execute:function(n){var r,o=[],i=!!n.scalar,c=new ActiveXObject("ADODB.Connection");i&&(r=new ActiveXObject("ADODB.Recordset")),c.CursorLocation=3,c.Open(n.connection),c.Execute(n.sql),i&&(r.Open(n.scalar,c,0,1),o=u(r)),e(o),t(c),i&&t(r)},query:function(n){var r=new ActiveXObject("ADODB.Connection"),o=new ActiveXObject("ADODB.Recordset");r.CursorLocation=3,r.Open(n.connection),o.Open(n.sql,r,0,1),e(u(o)),t(o),t(r)},schema:function(n){var r,o=new ActiveXObject("ADODB.Connection");o.CursorLocation=3,o.Open(n.connection),e(u(r=n.hasOwnProperty("id")?o.OpenSchema(n.type,n.criteria,n.id):n.hasOwnProperty("criteria")?o.OpenSchema(n.type,n.criteria):o.OpenSchema(n.type))),t(r),t(o)}},f=WScript.Arguments(0),a=JSON.parse(WScript.StdIn.ReadAll());try{c[f](a)}catch(s){p=s.description,WScript.StdErr.Write(p)}var p}();