!function(){"use strict";function t(t){return t.replace(/%22/g,'"').replace(/%25/g,"%")}function e(t){WScript.StdOut.Write(JSON.stringify(t))}function n(t){WScript.StdErr.Write(t)}function r(t){return 7===t||64===t||133===t||134===t||135===t}function o(t){return 128===t||204===t||205===t}function i(t){var e=new ActiveXObject("ADODB.Stream");e.Type=1,e.Open(),e.Position=0,e.Write(t),e.Position=0,e.Type=2;return e.ReadText()}function u(t){var e=[],n=t.Fields;if(!t.BOF||!t.EOF){var u,c,f,a,p,s=n.Count;for(t.MoveFirst();!t.EOF;){for(c={},u=0;u<s;u++)a=(f=n.Item(u)).Type,p=f.Value,r(a)?p=new Date(p):o(a)&&(p=i(p)),c[f.Name]=p;e.push(c),t.MoveNext()}}return e}function c(t){t.State&&t.Close()}"object"!=typeof JSON&&(JSON={}),function(){function t(t){return t<10?"0"+t:t}function e(){return this.valueOf()}function n(t){return f.lastIndex=0,f.test(t)?'"'+t.replace(f,function(t){var e=l[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function r(t,e){var o,i,u,c,f,a=p,l=e[t];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(t)),"function"==typeof O&&(l=O.call(e,t,l)),typeof l){case"string":return n(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(p+=s,f=[],"[object Array]"===Object.prototype.toString.apply(l)){for(c=l.length,o=0;o<c;o+=1)f[o]=r(o,l)||"null";return u=0===f.length?"[]":p?"[\n"+p+f.join(",\n"+p)+"\n"+a+"]":"["+f.join(",")+"]",p=a,u}if(O&&"object"==typeof O)for(c=O.length,o=0;o<c;o+=1)"string"==typeof O[o]&&(u=r(i=O[o],l))&&f.push(n(i)+(p?": ":":")+u);else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(u=r(i,l))&&f.push(n(i)+(p?": ":":")+u);return u=0===f.length?"{}":p?"{\n"+p+f.join(",\n"+p)+"\n"+a+"}":"{"+f.join(",")+"}",p=a,u}}var o=/^[\],:{}\s]*$/,i=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,u=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,c=/(?:^|:|,)(?:\s*\[)+/g,f=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+t(this.getUTCMonth()+1)+"-"+t(this.getUTCDate())+"T"+t(this.getUTCHours())+":"+t(this.getUTCMinutes())+":"+t(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=e,Number.prototype.toJSON=e,String.prototype.toJSON=e);var p,s,l,O;"function"!=typeof JSON.stringify&&(l={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(t,e,n){var o;if(p="",s="","number"==typeof n)for(o=0;o<n;o+=1)s+=" ";else"string"==typeof n&&(s=n);if(O=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return r("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(t,e){function n(t,r){var o,i,u=t[r];if(u&&"object"==typeof u)for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&((i=n(u,o))!==undefined?u[o]=i:delete u[o]);return e.call(t,r,u)}var r;if(t=String(t),a.lastIndex=0,a.test(t)&&(t=t.replace(a,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),o.test(t.replace(i,"@").replace(u,"]").replace(c,"")))return r=eval("("+t+")"),"function"==typeof e?n({"":r},""):r;throw new SyntaxError("JSON.parse")})}();var f={execute:function(t){var n,r=[],o=!!t.scalar,i=new ActiveXObject("ADODB.Connection");o&&(n=new ActiveXObject("ADODB.Recordset")),i.CursorLocation=3,i.Open(t.connection),i.Execute(t.sql),o&&(n.Open(t.scalar,i,0,1),r=u(n)),e(r),c(i),o&&c(n)},query:function(t){var n=new ActiveXObject("ADODB.Connection"),r=new ActiveXObject("ADODB.Recordset");n.CursorLocation=3,n.Open(t.connection),r.Open(t.sql,n,0,1),e(u(r)),c(r),c(n)},schema:function(t){var n,r=new ActiveXObject("ADODB.Connection");r.CursorLocation=3,r.Open(t.connection),e(u(n=t.hasOwnProperty("id")?r.OpenSchema(t.type,t.criteria,t.id):t.hasOwnProperty("criteria")?r.OpenSchema(t.type,t.criteria):r.OpenSchema(t.type))),c(n),c(r)}};try{f[WScript.Arguments(0)](JSON.parse(t(WScript.Arguments(1))))}catch(a){n(a.description)}}();